[[modules-gateway]]
== 本地 Gateway

本地 gateway 模块负责集群元信息和重启时共享数据的存储。

以下必须在主节点设置的 _静态_ 设定，控制一个新的主节点被选举后，尝试恢复集群状态和元数据之前的等待时间：

`gateway.expected_nodes`::

    集群中预期的节点数（数据或主）。加入集群的节点数达到这个数量后立即开始本地分片的恢复。默认为 `0`

`gateway.expected_master_nodes`::

    集群中预期的候选主节点数。加入集群的候选主节点达到这个数量后理解开始本地分片的恢复。默认为 `0`

`gateway.expected_data_nodes`::

    集群中预期的数据节点数。加入集群的数据节点数达到这个数量后立即开始本地分片的恢复。默认为 `0`

`gateway.recover_after_time`::

    如果没有达到预期的节点数量，则恢复过程将等待配置的时间，再尝试恢复。如果设置了一个 `预期节点` 的设定，默认为 `5m`。

如果等待超过 `recover_after_time` 的时间， 满足以下条件也会立即开始恢复：

`gateway.recover_after_nodes`::

    只要配置数量的节点（数据或主）加入集群就可以开始恢复。

`gateway.recover_after_master_nodes`::

    只要配置数量的候选主节点加入集群就可以开始恢复。

`gateway.recover_after_data_nodes`::

    只要配置数量的数据节点加入集群就可以开始恢复。

NOTE: 这些设定只在全面重启中起作用。
